###Some of the rxnSMILES in the CAS datset have invalid format. These function correct in valid smiles###

def format_str(string):
    string = string.replace('[\'','')
    string = string.replace('[]','')
    string = string.replace('\']','')
    string = string.replace('\', \'','.')
    return string   

def fix_smiles(string):
    string = string.replace('[NH4]Cl', '[NH4+].[Cl-]')
    string = string.replace('O=C1[O-][Ru+4]234567([CH2]=[CH]2[CH2-]3)([CH]2=[CH]4[CH-]5[CH]6=[CH]27)N2=C3C=CC=CC3=CC=C12', 'O=C(O[Ru]1(C2C=CC=C2)CC=C)C3=[N+]1C4=C(C=C3)C=CC=C4')
    string = string.replace('[NH4]O', '[NH4+].[OH-]')
    #string = string.replace('CC(C)(C)C1=CC=N2C(=C1)C1=CC(C(C)(C)C)=CC=N1[Ir+3]213([C]2=CC(F)=CC(F)=C2C2=CC=C(C(F)(F)F)C=N21)[C]1=CC(F)=CC(F)=C1C1=C/C=C(C(F)(F)F)/C=N13', 'CC(C)(C)C1=CC(=NC=C1)C2=NC=CC(=C2)C(C)(C)C.C1=CC(=NC=C1C(F)(F)F)C2=C(C=C(C=[C-]2)F)F.C1=CC(=NC=C1C(F)(F)F)C2=C(C=C(C=[C-]2)F)F.[Ir+3]')
    string = string.replace('CCO(CC)[Mg+2]([Br-])[Br-]', 'CCO(CC).[Mg]([Br])[Br]')
    string = string.replace('[F-][B+3]([F-])([F-])[F-]', 'F[B-](F)(F)F')
    string = string.replace('[F-][P+5]([F-])([F-])([F-])([F-])[F-]', '[F][P-]([F])([F])([F])([F])[F]')
    string = string.replace('[Cl-][Ag+][Cl-]', '[Cl][Ag-][Cl]')
    string = string.replace('CCO(CC)[B+3]([F-])([F-])[F-]','CCO(CC).[B-](F)(F)F')
    string = string.replace('C-2','C')
    string = string.replace('C-','C')
    string = string.replace('[B+3]','[B-]')
    string = string.replace('C1=CC=[C]([B-]2([C]3=CC=CC=C3)[NH2]CC[O-]2)C=C1','C1=CC=[C]([B-]2([C]3=CC=CC=C3)[NH2+]CC[O]2)C=C1')
    string = string.replace('[O-][Ag+][OH]','[O][Ag+][O]')
    string = string.replace('[Cl-]','[Cl]')
    string = string.replace('[Cl][Zr+4]12345678([Cl])([CH]9=[CH]1[CH-]2[CH]3=[CH]94)[CH]1=[CH]5[CH-]6[CH]7=[CH]18','Cl[Zr+2]Cl.[CH-]1C=CC=C1.[CH-]1C=CC=C1')
    string = string.replace('[Cl][Hf+4]12345678([Cl])([CH]9=[CH]1[CH-]2[CH]3=[CH]94)[CH]1=[CH]5[CH-]6[CH]7=[CH]18','Cl[Hf+2]Cl.[CH-]1C=CC=C1.[CH-]1C=CC=C1')
    string = string.replace('[CH-]6','[CH]6')
    string = string.replace('[CH-]2','[CH]2')
    string = string.replace('O=S(=O)([O-]','O=S(=O)([O]')
    string = string.replace(')[O-]S(=O)(=O)C',')[O]S(=O)(=O)C')
    string = string.replace('N#CC2=CC=C(F)C=C','[N+]#CC2=CC=C(F)C=C')
    string = string.replace('N#CC1=CC=C(F)C=C','[N+]#CC1=CC=C(F)C=C')
    string = string.replace('N#CC1=CC=CC=C1','[N+]#CC1=CC=CC=C1')
    string = string.replace('C#N[Ni+2]','C#[N+][Ni+2]')
    string = string.replace('CC1=CC=C(S(=O)(=O)[O-][Co+3]234[O-]C5=C(C(C)(C)C)C=C6C=C5C=N2C2CCCCC2/N3=C/C2=CC(=CC(C(C)(C)C)=C2[O-]4)OC(=O)CCOCCC(=O)OC2=CC(C(C)(C)C)=C3[O-][Co+3]45([O-]S(=O)(=O)C7=CC=C(C)C=C7)[O-]C7=C(C(C)(C)C)C=C(C=C7/C=N','CC1=CC=C(S(=O)(=O)[O][Co+3]234[O]C5=C(C(C)(C)C)C=C6C=C5C=[N+]2C2CCCCC2/[N+]3=C/C2=CC(=CC(C(C)(C)C)=C2[O]4)OC(=O)CCOCCC(=O)OC2=CC(C(C)(C)C)=C3[O][Co+3]45([O]S(=O)(=O)C7=CC=C(C)C=C7)[O]C7=C(C(C)(C)C)C=C(C=C7/C=[N+]')
    string = string.replace('N5=C/C3=C2)OC(=O)CCOCCC(=O)O6)C=C1','[N+]5=C/C3=C2)OC(=O)CCOCCC(=O)O6)C=C1')
    string = string.replace('O#C[Fe-2](C#O)(C#O)N#[O+]','[O+]#[C][Fe-2]([C]#[O+])([C]#[O+])[N]=[O]')
    string = string.replace('CO(C)[B-]([F-])([F-])[F-]','CO(C).[B-]([F])([F])[F]')
    string = string.replace('[F-][Sb+5]([F-])([F-])([F-])([F-])[F-]','[F][Sb-]([F])([F])([F])([F])[F]')
    string = string.replace('O=S(=O)([N-]([Au+]P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1)S(=O)(=O)C(F)(F)F)C(F)(F)F','O=S(=O)([N]([Au+]P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1)S(=O)(=O)C(F)(F)F)C(F)(F)F')
    string = string.replace('O=S(=O)([O])C(F)(F)F.[NH3][Au+]P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1','O=S(=O)([O-])C(F)(F)F.[NH3+][Au+]P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1')
    string = string.replace('O=C([O-][Au+]P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1)C(F)(F)F','O=C([O][Au+]P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1)C(F)(F)F')
    string = string.replace('O=N(=O)[O-]','[O-]-[N+](=O)[O]')
    string = string.replace('[O-]N(=O)=O','[O][N+](=O)-[O-]')
    string = string.replace('CP(C1=CC=CC=C1)(C1=CC=CC=C1)[Ir+]123(P(C)(C4=CC=CC=C4)C4=CC=CC=C4)[CH]4=[CH]1CC[CH]2=[CH]3CC4','[Ir+].C1CC=CCCC=C1.CP(c2ccccc2)c3ccccc3.CP(c4ccccc4)c5ccccc5')
    string = string.replace('N([I+]N2=C','[N+]([I+][N+]2=C')
    string = string.replace('P([Au+][N-]','P([Au+][N]')
    string = string.replace('CC(C)(C)C1=CC=N2C(=C1)C1=CC(C(C)(C)C)=CC=N1[Ir+3]213([C]2=CC(F)=CC(F)=C2C2=CC=C(C(F)(F)F)C=N21)[C]1=CC(F)=CC(F)=C1C1=C/C=C(C(F)(F)F)/C=N','CC(C)(C)C1=CC=[N+]2C(=C1)C1=CC(C(C)(C)C)=CC=[N+]1[Ir+3]213([C]2=CC(F)=CC(F)=C2C2=CC=C(C(F)(F)F)C=[N+]21)[C]1=CC(F)=CC(F)=C1C1=C/C=C(C(F)(F)F)/C=[N+]')
    string = string.replace('CC1=CC(C(C)(C)C)=NC(C(C)(C)C)=C1.C1=CC=N2C(=C1)C1=CC=CC=N1[Ru+2]213(N2=CC=CC=C2C2=CC=CC=N21)N1=CC=CC=C1C1=CC=CC=N13','CC1=CC(C(C)(C)C)=[N+]C(C(C)(C)C)=C1.C1=CC=[N+]2C(=C1)C1=CC=CC=[N+]1[Ru+2]213([N+]2=CC=CC=C2C2=CC=CC=[N+]21)[N+]1=CC=CC=C1C1=CC=CC=[N+]13')
    string = string.replace('CCCCO(CCCC)[B-]([F-])([F-])[F-]','CCCCO(CCCC).[B]([F])([F])[F]')
    string = string.replace('CC#N[Pd+2](N#CC)(N#CC)N#CC.F[B-](F)(F)F','CC#[N+][Pd+2]([N+]#CC)([N+]#CC)[N+]#CC.F[B-](F)(F)F')
    string = string.replace('O=S(=O)(O)O.[Na].[Cl][Au+]P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1.O=S1(C(F)(F)F)=O[Ag+]O=S(=O)(C(F)(F)F)[N-]1','O=S(=O)(O)O.[Na].[Cl][Au+]P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1.O=S1(C(F)(F)F)=[O+][Ag+][O+]=S(=O)(C(F)(F)F)[N-]1')
    string = string.replace('O=[O-][K+]','O=O.[K+]')
    string = string.replace('CC(C)(C)[Si](C)(C)C1#C([Si](C)(C)C(C)(C)C)[Au+]1P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1.[F][Sb-]([F])([F])([F])([F])[F]','CC(C)(C)[Si](C)(C)C#C([Si](C)(C)C(C)(C)C).[Au+]P(C1=CC=CC=C1)(C1=CC=CC=C1)C1=CC=CC=C1.[F][Sb-]([F])([F])([F])([F])[F]')
    string = string.replace('CC#N[B-]([F-])([F-])[F-]','CC#N.[B]([F])([F])[F]')
    string = string.replace('CC#N[Cu+](N#CC)(N#CC)N#CC.[F][P-]([F])([F])([F])([F])[F]','CC#N.[Cu+].N#CC.N#CC.N#CC.[F][P-]([F])([F])([F])([F])[F]')
    string = string.replace('CC#N[Ag+](N#CC)(N#CC)N#CC.F[B-](F)(F)F','CC#N.[Ag+].N#CC.N#CC.N#CC.F[B-](F)(F)F')

    return string

def fix_rxns_failing_in_chemprop(string):
    string = string.replace('([N:1](=[N:2][OH:5])(=[O:3])[N:4]1[C@H:6]([CH2:8][OH:11])[CH2:9][CH2:10][CH2:7]1.[NaH])', '[N:1](=[N:2][OH:5])(=[O:3])[N:4]1[C@H:6]([CH2:8][OH:11])[CH2:9][CH2:10][CH2:7]1.[NaH]')
    string = string.replace('([N:1]([N:2](=[N:5][OH:8])=[O:6])([CH2:3][CH2:7][OH:9])[CH3:4].[NaH])','[N:1]([N:2](=[N:5][OH:8])=[O:6])([CH2:3][CH2:7][OH:9])[CH3:4].[NaH]')
    string = string.replace('(O[C:24]([CH3:25])=[O:26].[NaH])','O[C:24]([CH3:25])=[O:26].[NaH]')
    string = string.replace('([N:1](=[N:2][OH:5])(=[O:3])[N:4]1[CH2:6][CH2:8][CH2:9][CH2:7]1.[NaH])','[N:1](=[N:2][OH:5])(=[O:3])[N:4]1[CH2:6][CH2:8][CH2:9][CH2:7]1.[NaH]')
    string = string.replace('([N:1](=[N:2][OH:5])(=[O:3])[N:4]1[CH2:6][CH2:8][CH2:10][CH2:9][CH2:7]1.[NaH])','[N:1](=[N:2][OH:5])(=[O:3])[N:4]1[CH2:6][CH2:8][CH2:10][CH2:9][CH2:7]1.[NaH]')
    string = string.replace('([Cl-].[O:12]([C:13]1=[CH:16]/[C:21]2=[C:25](\[O+:19]=[C:15]/1[C:20]1=[CH:26][C:33]([OH:40])=[C:41]([OH:43])[CH:34]=[CH:27]1)[CH:32]=[C:39]([OH:42])[CH:36]=[C:28]2[OH:35])[C@@H:14]1[O:17][C@H:22]([CH2:29][OH:37])[C@@H:30]([OH:38])[C@H:24]([OH:31])[C@H:18]1[OH:23])','[Cl-].[O:12]([C:13]1=[CH:16]/[C:21]2=[C:25](\[O+:19]=[C:15]/1[C:20]1=[CH:26][C:33]([OH:40])=[C:41]([OH:43])[CH:34]=[CH:27]1)[CH:32]=[C:39]([OH:42])[CH:36]=[C:28]2[OH:35])[C@@H:14]1[O:17][C@H:22]([CH2:29][OH:37])[C@@H:30]([OH:38])[C@H:24]([OH:31])[C@H:18]1[OH:23]')
    string = string.replace('([CH2:1]([NH:2][C:4]([O:7][C:11]([CH3:13])([CH3:14])[CH3:15])=[O:8])[CH:3]1[CH2:5][CH2:9][N:12]([N:16](=[N:17][OH:19])=[O:18])[CH2:10][CH2:6]1.[NaH])','[CH2:1]([NH:2][C:4]([O:7][C:11]([CH3:13])([CH3:14])[CH3:15])=[O:8])[CH:3]1[CH2:5][CH2:9][N:12]([N:16](=[N:17][OH:19])=[O:18])[CH2:10][CH2:6]1.[NaH]')
    string = string.replace('([H][C@:41]1([C@@H:38]([C@@H:39]([CH2:42][OH:46])[OH:43])[OH:40])[C@H:44]([NH:47][C:50]([CH3:54])=[O:55])[C@@H:48]([OH:51])[CH2:52][C@@:49](O)([C:53]([OH:56])=[O:57])[O:45]1.[NaH])','[H][C@:41]1([C@@H:38]([C@@H:39]([CH2:42][OH:46])[OH:43])[OH:40])[C@H:44]([NH:47][C:50]([CH3:54])=[O:55])[C@@H:48]([OH:51])[CH2:52][C@@:49](O)([C:53]([OH:56])=[O:57])[O:45]1.[NaH]')
    string = string.replace('([CH:1](=[C:2](/[C:4]([O:8][CH2:13][CH3:17])=[O:9])[OH:5])\[C:3]1=[C:6]([N:10](=[O:14])=[O:15])[CH:11]=[CH:16][CH:12]=[CH:7]1.[KH])','[CH:1](=[C:2](/[C:4]([O:8][CH2:13][CH3:17])=[O:9])[OH:5])\[C:3]1=[C:6]([N:10](=[O:14])=[O:15])[CH:11]=[CH:16][CH:12]=[CH:7]1.[KH]')
    string = string.replace('([N:1](=[N:2][OH:5])(=[O:3])[N:4]1[CH2:6][CH2:8][CH:10]([OH:11])[CH2:9][CH2:7]1.[NaH])','[N:1](=[N:2][OH:5])(=[O:3])[N:4]1[CH2:6][CH2:8][CH:10]([OH:11])[CH2:9][CH2:7]1.[NaH]')
    string = string.replace('([N:1](=[N:2][OH:5])(=[O:3])[N:4]1[CH2:6][CH2:8][N:10]([CH2:11][CH2:12][OH:13])[CH2:9][CH2:7]1.[NaH])','[N:1](=[N:2][OH:5])(=[O:3])[N:4]1[CH2:6][CH2:8][N:10]([CH2:11][CH2:12][OH:13])[CH2:9][CH2:7]1.[NaH]')
    string = string.replace('([C:1]([O:2][C:5]([CH3:8])([CH3:9])[CH3:10])(=[O:3])[N:4]1[CH2:6][CH2:11][N:13]([N:14](=[N:15][OH:17])=[O:16])[CH2:12][CH2:7]1.[NaH])','[C:1]([O:2][C:5]([CH3:8])([CH3:9])[CH3:10])(=[O:3])[N:4]1[CH2:6][CH2:11][N:13]([N:14](=[N:15][OH:17])=[O:16])[CH2:12][CH2:7]1.[NaH]')
    string = string.replace('([CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([OH:19])=[C:14]([F:18])[CH:10]=[C:7]12.[NaH])','[CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([OH:19])=[C:14]([F:18])[CH:10]=[C:7]12.[NaH]')
    string = string.replace('([CH3:1][C:2]1=[C:3]2[C:5](=[CH:10][CH:8]=[C:4]1[OH:7])[C:9]([CH2:12][S:15](=[O:16])(=[O:17])[OH:18])=[CH:13][C:11](=[O:14])[O:6]2.[NaH])','[CH3:1][C:2]1=[C:3]2[C:5](=[CH:10][CH:8]=[C:4]1[OH:7])[C:9]([CH2:12][S:15](=[O:16])(=[O:17])[OH:18])=[CH:13][C:11](=[O:14])[O:6]2.[NaH]')
    string = string.replace('([C:1]([CH3:2])([OH:3])=[O:4].[PbH2])','[C:1]([CH3:2])([OH:3])=[O:4].[PbH2]')
    string = string.replace('([CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:16])[O:15][C:10]2=[CH:14][C:17]([OH:20])=[C:12]3[C:9](=[C:7]12)[CH:13]=[CH:19][CH:21]=[CH:18]3.[NaH])','[CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:16])[O:15][C:10]2=[CH:14][C:17]([OH:20])=[C:12]3[C:9](=[C:7]12)[CH:13]=[CH:19][CH:21]=[CH:18]3.[NaH]')
    string = string.replace('([H][C@@]1(N2C=CC(N)=NC2=O)O[C@H](COP(=O)(O)O[C@:1]2([C:2]([OH:5])=[O:6])[O:3][C@@:7]([H])([C@@H:9]([C@@H:12]([CH2:15][OH:18])[OH:16])[OH:13])[C@H:10]([NH:14][C:17]([CH3:19])=[O:20])[C@@H:8]([OH:11])[CH2:4]2)[C@@H](O)[C@H]1O.[NaH])','[H][C@@]1(N2C=CC(N)=NC2=O)O[C@H](COP(=O)(O)O[C@:1]2([C:2]([OH:5])=[O:6])[O:3][C@@:7]([H])([C@@H:9]([C@@H:12]([CH2:15][OH:18])[OH:16])[OH:13])[C@H:10]([NH:14][C:17]([CH3:19])=[O:20])[C@@H:8]([OH:11])[CH2:4]2)[C@@H](O)[C@H]1O.[NaH]')
    string = string.replace('([H][C@:11]12[C:6]3=[C:10]([CH:9]=[C:5]([O:8][CH3:13])[C:3]([O:1][CH3:2])=[C:4]3[O:7][C:12]3=[C:18]([O:23][CH3:29])[CH:24]=[C:27]4[C:22](=[CH:17]3)[C@:28]([H])([CH2:33][C:38]3=[CH:42][CH:45]=[C:40]([O:35][C:30]5=[CH:25][C:20](=[CH:26][CH:31]=[C:36]5[OH:41])[CH2:15]1)[CH:44]=[CH:43]3)[N:34]([CH3:39])[CH2:37][CH2:32]4)[CH2:14][CH2:19][N:16]2[CH3:21].[KH])','[H][C@:11]12[C:6]3=[C:10]([CH:9]=[C:5]([O:8][CH3:13])[C:3]([O:1][CH3:2])=[C:4]3[O:7][C:12]3=[C:18]([O:23][CH3:29])[CH:24]=[C:27]4[C:22](=[CH:17]3)[C@:28]([H])([CH2:33][C:38]3=[CH:42][CH:45]=[C:40]([O:35][C:30]5=[CH:25][C:20](=[CH:26][CH:31]=[C:36]5[OH:41])[CH2:15]1)[CH:44]=[CH:43]3)[N:34]([CH3:39])[CH2:37][CH2:32]4)[CH2:14][CH2:19][N:16]2[CH3:21].[KH]')
    string = string.replace('([H][C@@]1(N2C=CC(=O)NC2=O)O[C@H](COP(=O)(O)OP(=O)(O)O[C@H:1]2[O:2][C@H:4]([C:7]([OH:10])=[O:11])[C@@H:8]([OH:12])[C@H:6]([OH:9])[C@H:3]2[OH:5])[C@@H](O)[C@H]1O.[NaH])','[H][C@@]1(N2C=CC(=O)NC2=O)O[C@H](COP(=O)(O)OP(=O)(O)O[C@H:1]2[O:2][C@H:4]([C:7]([OH:10])=[O:11])[C@@H:8]([OH:12])[C@H:6]([OH:9])[C@H:3]2[OH:5])[C@@H](O)[C@H]1O.[NaH]')
    string = string.replace('([H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([CH2:19][N:25]=[N+:26]=[N-:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@:12]([C:17]([OH:23])=[O:24])([OH:18])[O:8]1.[NaH])','[H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([CH2:19][N:25]=[N+:26]=[N-:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@:12]([C:17]([OH:23])=[O:24])([OH:18])[O:8]1.[NaH]')
    string = string.replace('([N:1](=[O:2])(=[O:3])[C:4]1=[CH:5][CH:7]=[C:9]([OH:10])[CH:8]=[CH:6]1.[NaH])','[N:1](=[O:2])(=[O:3])[C:4]1=[CH:5][CH:7]=[C:9]([OH:10])[CH:8]=[CH:6]1.[NaH]')
    string = string.replace('([N:24](=[O:25])(=[O:26])[C:27]1=[CH:28][CH:30]=[C:32]([OH:33])[CH:31]=[CH:29]1.[NaH])','[N:24](=[O:25])(=[O:26])[C:27]1=[CH:28][CH:30]=[C:32]([OH:33])[CH:31]=[CH:29]1.[NaH]')
    string = string.replace('([KH].[N:1](=[O:2])(=[O:3])[C:4]1=[CH:5][C:7]([Cl:9])=[C:10]([OH:11])[CH:8]=[CH:6]1)','[KH].[N:1](=[O:2])(=[O:3])[C:4]1=[CH:5][C:7]([Cl:9])=[C:10]([OH:11])[CH:8]=[CH:6]1')
    string = string.replace('([H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([O:19][CH2:25][C:26]#[CH:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@:12]([C:17]([OH:23])=[O:24])([OH:18])[O:8]1.[NaH])','[H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([O:19][CH2:25][C:26]#[CH:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@:12]([C:17]([OH:23])=[O:24])([OH:18])[O:8]1.[NaH]')
    string = string.replace('([CH3:1][C:2]1=[CH:4][C:7](=[O:11])[O:8][C:5]2=[CH:9][C:12]([OH:13])=[CH:10][CH:6]=[C:3]12.[NaH])','[CH3:1][C:2]1=[CH:4][C:7](=[O:11])[O:8][C:5]2=[CH:9][C:12]([OH:13])=[CH:10][CH:6]=[C:3]12.[NaH]')
    string = string.replace('(O[C:17]1=[C:14]([F:18])[CH:10]=[C:7]2[C:3]([CH2:1][S:2](=[O:4])(=[O:5])[OH:6])=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]1[F:16].[NaH])','O[C:17]1=[C:14]([F:18])[CH:10]=[C:7]2[C:3]([CH2:1][S:2](=[O:4])(=[O:5])[OH:6])=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]1[F:16].[NaH]')
    string = string.replace('([H][C@@]1(N2C=CC(=O)NC2=O)O[C@H](COP(=O)(O)OP(=O)(O)O[C@H:1]2[O:2][C@H:4]([C:7]([OH:10])=[O:11])[C@@H:8]([OH:12])[C@H:6]([OH:9])[C@H:3]2[OH:5])[C@@H](O)[C@H]1O.[KH])','[H][C@@]1(N2C=CC(=O)NC2=O)O[C@H](COP(=O)(O)OP(=O)(O)O[C@H:1]2[O:2][C@H:4]([C:7]([OH:10])=[O:11])[C@@H:8]([OH:12])[C@H:6]([OH:9])[C@H:3]2[OH:5])[C@@H](O)[C@H]1O.[KH]')
    string = string.replace('([C:29]([CH3:30])([OH:31])=[O:32].[PbH2])','[C:29]([CH3:30])([OH:31])=[O:32].[PbH2]')
    string = string.replace('([C:24]([CH3:25])([OH:26])=[O:27].[PbH2])','[C:24]([CH3:25])([OH:26])=[O:27].[PbH2]')
    string = string.replace('([H][C@:26]1([N:29]2[C:32](=[O:35])[N:36]=[C:39]([NH2:41])[CH:37]=[CH:33]2)[C@H:25]([OH:24])[C@H:27]([OH:30])[C@@H:31]([CH2:34][O:38][P:40](O)(=[O:42])[OH:43])[O:28]1.[NaH])','[H][C@:26]1([N:29]2[C:32](=[O:35])[N:36]=[C:39]([NH2:41])[CH:37]=[CH:33]2)[C@H:25]([OH:24])[C@H:27]([OH:30])[C@@H:31]([CH2:34][O:38][P:40](O)(=[O:42])[OH:43])[O:28]1.[NaH]')
    string = string.replace('([C:28]([CH3:29])([OH:30])=[O:31].[PbH2])','[C:28]([CH3:29])([OH:30])=[O:31].[PbH2]')
    string = string.replace('([KH].[O:1]=[C:2]1[C:3]2=[CH:6][CH:11]=[C:14]([OH:17])[CH:10]=[C:5]2[O:9][CH:7]=[C:4]1[C:8]1=[N:13][CH:16]=[CH:15][NH:12]1)','[KH].[O:1]=[C:2]1[C:3]2=[CH:6][CH:11]=[C:14]([OH:17])[CH:10]=[C:5]2[O:9][CH:7]=[C:4]1[C:8]1=[N:13][CH:16]=[CH:15][NH:12]1')
    string = string.replace('([Cl:1][C:2]1=[C:3]([C:5]2=[C:8]([C:12]3=[C:14]([Cl:17])[CH:18]=[CH:22][CH:19]=[CH:15]3)[N:11]=[C:13]([C:16]3=[CH:21][O:25][C:26]4=[CH:28][C:30]([OH:31])=[CH:29][CH:27]=[C:24]4[C:20]3=[O:23])[NH:9]2)[CH:6]=[CH:10][CH:7]=[CH:4]1.[KH])','[Cl:1][C:2]1=[C:3]([C:5]2=[C:8]([C:12]3=[C:14]([Cl:17])[CH:18]=[CH:22][CH:19]=[CH:15]3)[N:11]=[C:13]([C:16]3=[CH:21][O:25][C:26]4=[CH:28][C:30]([OH:31])=[CH:29][CH:27]=[C:24]4[C:20]3=[O:23])[NH:9]2)[CH:6]=[CH:10][CH:7]=[CH:4]1.[KH]')
    string = string.replace('([KH].[O:1]=[C:2]1[C:3]([C:6]2=[N:11][C:15]([CH3:18])=[C:14]([CH3:17])[NH:10]2)=[CH:5][O:9][C:7]2=[CH:12][C:16]([OH:19])=[CH:13][CH:8]=[C:4]12)','[KH].[O:1]=[C:2]1[C:3]([C:6]2=[N:11][C:15]([CH3:18])=[C:14]([CH3:17])[NH:10]2)=[CH:5][O:9][C:7]2=[CH:12][C:16]([OH:19])=[CH:13][CH:8]=[C:4]12')
    string = string.replace('([H][C@@]1(N2C=CC(=O)NC2=O)O[C@H](COP(=O)(O)OP(=O)(O)O[C@H:22]2[O:23][C@H:25]([C:28]([OH:31])=[O:32])[C@@H:29]([OH:33])[C@H:27]([OH:30])[C@H:24]2[OH:26])[C@@H](O)[C@H]1O.[NaH])','[H][C@@]1(N2C=CC(=O)NC2=O)O[C@H](COP(=O)(O)OP(=O)(O)O[C@H:22]2[O:23][C@H:25]([C:28]([OH:31])=[O:32])[C@@H:29]([OH:33])[C@H:27]([OH:30])[C@H:24]2[OH:26])[C@@H](O)[C@H]1O.[NaH]')
    string = string.replace('([CH3:39][C:40]1=[CH:42][C:45](=[O:49])[O:46][C:43]2=[CH:47][C:50]([OH:51])=[CH:48][CH:44]=[C:41]12.[NaH])','[CH3:39][C:40]1=[CH:42][C:45](=[O:49])[O:46][C:43]2=[CH:47][C:50]([OH:51])=[CH:48][CH:44]=[C:41]12.[NaH]')
    string = string.replace('([AlH3].[O:46]([P:47]([O:49][CH2:53][CH2:55][CH2:57][CH3:58])(=[O:50])[OH:51])[CH2:48][CH2:52][CH2:54][CH3:56])','[AlH3].[O:46]([P:47]([O:49][CH2:53][CH2:55][CH2:57][CH3:58])(=[O:50])[OH:51])[CH2:48][CH2:52][CH2:54][CH3:56]')
    string = string.replace('([KH].[O:1]=[C:2]1[C:3]([C:6]2=[N:11][CH:15]=[C:14]([C:17]3=[CH:19][CH:21]=[CH:23][CH:22]=[CH:20]3)[NH:10]2)=[CH:5][O:9][C:7]2=[CH:12][C:16]([OH:18])=[CH:13][CH:8]=[C:4]12)','[KH].[O:1]=[C:2]1[C:3]([C:6]2=[N:11][CH:15]=[C:14]([C:17]3=[CH:19][CH:21]=[CH:23][CH:22]=[CH:20]3)[NH:10]2)=[CH:5][O:9][C:7]2=[CH:12][C:16]([OH:18])=[CH:13][CH:8]=[C:4]12')
    string = string.replace('([C:25]([C:26]([OH:30])=[O:31])([CH3:27])([CH3:28])[CH3:29].[CsH])','[C:25]([C:26]([OH:30])=[O:31])([CH3:27])([CH3:28])[CH3:29].[CsH]')
    string = string.replace('([KH].[O:1]=[C:2]1[C:3]([C:5]2=[N:10][C:15]([C:18]3=[CH:22][CH:26]=[CH:29][CH:27]=[CH:23]3)=[C:14]([C:17]3=[CH:20][CH:24]=[CH:28][CH:25]=[CH:21]3)[NH:9]2)=[CH:6][O:11][C:7]2=[CH:12][C:16]([OH:19])=[CH:13][CH:8]=[C:4]12)','[KH].[O:1]=[C:2]1[C:3]([C:5]2=[N:10][C:15]([C:18]3=[CH:22][CH:26]=[CH:29][CH:27]=[CH:23]3)=[C:14]([C:17]3=[CH:20][CH:24]=[CH:28][CH:25]=[CH:21]3)[NH:9]2)=[CH:6][O:11][C:7]2=[CH:12][C:16]([OH:19])=[CH:13][CH:8]=[C:4]12')
    string = string.replace('([KH].[O:1]([CH3:2])[C:3]1=[CH:4][CH:6]=[C:8]([C:9]2=[C:10]([C:13]3=[CH:15][CH:18]=[CH:22][CH:19]=[CH:16]3)[N:12]=[C:14]([C:17]3=[CH:21][O:25][C:26]4=[CH:28][C:30]([OH:31])=[CH:29][CH:27]=[C:24]4[C:20]3=[O:23])[NH:11]2)[CH:7]=[CH:5]1)','[KH].[O:1]([CH3:2])[C:3]1=[CH:4][CH:6]=[C:8]([C:9]2=[C:10]([C:13]3=[CH:15][CH:18]=[CH:22][CH:19]=[CH:16]3)[N:12]=[C:14]([C:17]3=[CH:21][O:25][C:26]4=[CH:28][C:30]([OH:31])=[CH:29][CH:27]=[C:24]4[C:20]3=[O:23])[NH:11]2)[CH:7]=[CH:5]1')
    string = string.replace('([C:25]([OH:26])(=[O:27])[C:28]1=[CH:30][CH:33]=[CH:34][C:31]2=[C:29]1[CH:32]=[CH:36][CH:37]=[CH:35]2.[CsH])','[C:25]([OH:26])(=[O:27])[C:28]1=[CH:30][CH:33]=[CH:34][C:31]2=[C:29]1[CH:32]=[CH:36][CH:37]=[CH:35]2.[CsH]')
    string = string.replace('([C:25]([OH:26])(=[O:27])[C:28]1=[CH:29][C:31]2=[C:33]([CH:32]=[CH:30]1)[CH:35]=[CH:37][CH:36]=[CH:34]2.[CsH])','[C:25]([OH:26])(=[O:27])[C:28]1=[CH:29][C:31]2=[C:33]([CH:32]=[CH:30]1)[CH:35]=[CH:37][CH:36]=[CH:34]2.[CsH]')
    string = string.replace('([C:25]([OH:26])(=[O:27])[C:28]1=[CH:29][CH:31]=[CH:33][CH:32]=[CH:30]1.[CsH])','[C:25]([OH:26])(=[O:27])[C:28]1=[CH:29][CH:31]=[CH:33][CH:32]=[CH:30]1.[CsH]')
    string = string.replace('([H][C@:32]1([C@@H:29]([C@@H:30]([CH2:33][OH:37])[OH:34])[OH:31])[C@H:35]([NH:38][C:41]([CH3:46])=[O:47])[C@@H:39]([OH:42])[CH2:43][C@@:40]([C:44]([OH:48])=[O:49])([O:45][CH2:18][C@H:12]2[O:6][C@@H:3]([O:1][C@@H:2]3[C@@H:4]([CH2:8][OH:15])[O:9][C@@H:16]([O:21][CH2:23][CH2:24][CH2:25][N:26]=[N+:27]=[N-:28])[C@H:11]([OH:17])[C@H:5]3[OH:10])[C@H:7]([OH:13])[C@@H:14]([OH:20])[C@H:19]2[OH:22])[O:36]1.[NaH])','[H][C@:32]1([C@@H:29]([C@@H:30]([CH2:33][OH:37])[OH:34])[OH:31])[C@H:35]([NH:38][C:41]([CH3:46])=[O:47])[C@@H:39]([OH:42])[CH2:43][C@@:40]([C:44]([OH:48])=[O:49])([O:45][CH2:18][C@H:12]2[O:6][C@@H:3]([O:1][C@@H:2]3[C@@H:4]([CH2:8][OH:15])[O:9][C@@H:16]([O:21][CH2:23][CH2:24][CH2:25][N:26]=[N+:27]=[N-:28])[C@H:11]([OH:17])[C@H:5]3[OH:10])[C@H:7]([OH:13])[C@@H:14]([OH:20])[C@H:19]2[OH:22])[O:36]1.[NaH]')
    string = string.replace('([H][C@:41]1([C@@H:38]([C@@H:39]([CH2:42][OH:46])[OH:43])[OH:40])[C@H:44]([NH:47][C:50]([CH3:54])=[O:55])[C@@H:48]([OH:51])[CH2:52][C@:49]([O:25][CH2:18][C@@H:11]2[C@H:5]([OH:10])[C@H:2]([O:1][C@@H:3]3[O:6][C@H:12]([CH2:19][OH:26])[C@H:20]([OH:27])[C@H:14]([OH:21])[C@H:7]3[OH:13])[C@@H:4]([NH:8][C:15]([CH3:22])=[O:23])[C@@H:9]([O:16][C@@H:24]([C@@H:28]([C:30]([O:32][CH3:35])=[O:33])[NH:31][C:34]([CH3:36])=[O:37])[CH3:29])[O:17]2)([C:53]([OH:56])=[O:57])[O:45]1.[NaH])','[H][C@:41]1([C@@H:38]([C@@H:39]([CH2:42][OH:46])[OH:43])[OH:40])[C@H:44]([NH:47][C:50]([CH3:54])=[O:55])[C@@H:48]([OH:51])[CH2:52][C@:49]([O:25][CH2:18][C@@H:11]2[C@H:5]([OH:10])[C@H:2]([O:1][C@@H:3]3[O:6][C@H:12]([CH2:19][OH:26])[C@H:20]([OH:27])[C@H:14]([OH:21])[C@H:7]3[OH:13])[C@@H:4]([NH:8][C:15]([CH3:22])=[O:23])[C@@H:9]([O:16][C@@H:24]([C@@H:28]([C:30]([O:32][CH3:35])=[O:33])[NH:31][C:34]([CH3:36])=[O:37])[CH3:29])[O:17]2)([C:53]([OH:56])=[O:57])[O:45]1.[NaH]')
    string = string.replace('([CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([O:19][C@H:30]3[C@H:26]([O:29][C:34]([CH3:38])=[O:39])[C@@H:22]([O:20][C:21]([CH3:23])=[O:24])[C@H:25]([O:27][C:31]([CH3:35])=[O:36])[C@@H:28]([CH2:32][O:37][C:40]([CH3:41])=[O:42])[O:33]3)=[C:14]([F:18])[CH:10]=[C:7]12.[NaH])','[CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([O:19][C@H:30]3[C@H:26]([O:29][C:34]([CH3:38])=[O:39])[C@@H:22]([O:20][C:21]([CH3:23])=[O:24])[C@H:25]([O:27][C:31]([CH3:35])=[O:36])[C@@H:28]([CH2:32][O:37][C:40]([CH3:41])=[O:42])[O:33]3)=[C:14]([F:18])[CH:10]=[C:7]12.[NaH]')
    string = string.replace('([CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([O:19][C@H:28]3[C@H:25]([O:27][C:31]([CH3:34])=[O:35])[C@@H:22]([O:20][C:21]([CH3:23])=[O:24])[C@H:26]([O:29][C:33]([CH3:36])=[O:37])[CH2:30][O:32]3)=[C:14]([F:18])[CH:10]=[C:7]12.[NaH])','[CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([O:19][C@H:28]3[C@H:25]([O:27][C:31]([CH3:34])=[O:35])[C@@H:22]([O:20][C:21]([CH3:23])=[O:24])[C@H:26]([O:29][C:33]([CH3:36])=[O:37])[CH2:30][O:32]3)=[C:14]([F:18])[CH:10]=[C:7]12.[NaH]')
    string = string.replace('([H][C@:32]1([C@@H:29]([C@@H:30]([CH2:33][OH:37])[OH:34])[OH:31])[C@H:35]([NH:38][C:41]([CH3:46])=[O:47])[C@@H:39]([OH:42])[CH2:43][C@@:40]([C:44]([OH:48])=[O:49])([O:45][C@@H:14]2[C@@H:7]([OH:13])[C@H:3]([O:1][C@@H:2]3[C@@H:4]([CH2:8][OH:15])[O:9][C@@H:16]([O:20][CH2:23][CH2:24][CH2:25][N:26]=[N+:27]=[N-:28])[C@H:11]([OH:17])[C@H:5]3[OH:10])[O:6][C@H:12]([CH2:18][OH:21])[C@@H:19]2[OH:22])[O:36]1.[NaH])','[H][C@:32]1([C@@H:29]([C@@H:30]([CH2:33][OH:37])[OH:34])[OH:31])[C@H:35]([NH:38][C:41]([CH3:46])=[O:47])[C@@H:39]([OH:42])[CH2:43][C@@:40]([C:44]([OH:48])=[O:49])([O:45][C@@H:14]2[C@@H:7]([OH:13])[C@H:3]([O:1][C@@H:2]3[C@@H:4]([CH2:8][OH:15])[O:9][C@@H:16]([O:20][CH2:23][CH2:24][CH2:25][N:26]=[N+:27]=[N-:28])[C@H:11]([OH:17])[C@H:5]3[OH:10])[O:6][C@H:12]([CH2:18][OH:21])[C@@H:19]2[OH:22])[O:36]1.[NaH]')
    string = string.replace('([CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([O:19][C@H:36]3[C@H:28]([O:35][C:44]([CH3:51])=[O:52])[C@@H:23]([O:27][C:34]([CH3:42])=[O:43])[C@H:21]([O:20][C@H:22]4[C@H:25]([O:31][C:38]([CH3:46])=[O:47])[C@@H:32]([O:39][C:48]([CH3:55])=[O:56])[C@H:40]([O:49][C:57]([CH3:59])=[O:60])[C@@H:33]([CH2:41][O:50][C:58]([CH3:61])=[O:62])[O:26]4)[C@@H:24]([CH2:29][O:37][C:45]([CH3:53])=[O:54])[O:30]3)=[C:14]([F:18])[CH:10]=[C:7]12.[NaH])','[CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([O:19][C@H:36]3[C@H:28]([O:35][C:44]([CH3:51])=[O:52])[C@@H:23]([O:27][C:34]([CH3:42])=[O:43])[C@H:21]([O:20][C@H:22]4[C@H:25]([O:31][C:38]([CH3:46])=[O:47])[C@@H:32]([O:39][C:48]([CH3:55])=[O:56])[C@H:40]([O:49][C:57]([CH3:59])=[O:60])[C@@H:33]([CH2:41][O:50][C:58]([CH3:61])=[O:62])[O:26]4)[C@@H:24]([CH2:29][O:37][C:45]([CH3:53])=[O:54])[O:30]3)=[C:14]([F:18])[CH:10]=[C:7]12.[NaH]')
    string = string.replace('([CH3:1][C:2]1=[C:3]2[C:5](=[CH:10][CH:8]=[C:4]1[O:7][C@H:29]1[C@H:25]([O:28][C:33]([CH3:37])=[O:38])[C@@H:21]([O:19][C:20]([CH3:22])=[O:23])[C@H:24]([O:26][C:30]([CH3:34])=[O:35])[C@@H:27]([CH2:31][O:36][C:39]([CH3:40])=[O:41])[O:32]1)[C:9]([CH2:12][S:15](=[O:16])(=[O:17])[OH:18])=[CH:13][C:11](=[O:14])[O:6]2.[NaH])','[CH3:1][C:2]1=[C:3]2[C:5](=[CH:10][CH:8]=[C:4]1[O:7][C@H:29]1[C@H:25]([O:28][C:33]([CH3:37])=[O:38])[C@@H:21]([O:19][C:20]([CH3:22])=[O:23])[C@H:24]([O:26][C:30]([CH3:34])=[O:35])[C@@H:27]([CH2:31][O:36][C:39]([CH3:40])=[O:41])[O:32]1)[C:9]([CH2:12][S:15](=[O:16])(=[O:17])[OH:18])=[CH:13][C:11](=[O:14])[O:6]2.[NaH]')
    string = string.replace('([CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:16])[O:15][C:10]2=[CH:14][C:17]([O:20][C@H:32]3[C@H:28]([O:31][C:36]([CH3:40])=[O:41])[C@@H:24]([O:22][C:23]([CH3:25])=[O:26])[C@H:27]([O:29][C:33]([CH3:37])=[O:38])[C@@H:30]([CH2:34][O:39][C:42]([CH3:43])=[O:44])[O:35]3)=[C:12]3[C:9](=[C:7]12)[CH:13]=[CH:19][CH:21]=[CH:18]3.[NaH])','[CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:16])[O:15][C:10]2=[CH:14][C:17]([O:20][C@H:32]3[C@H:28]([O:31][C:36]([CH3:40])=[O:41])[C@@H:24]([O:22][C:23]([CH3:25])=[O:26])[C@H:27]([O:29][C:33]([CH3:37])=[O:38])[C@@H:30]([CH2:34][O:39][C:42]([CH3:43])=[O:44])[O:35]3)=[C:12]3[C:9](=[C:7]12)[CH:13]=[CH:19][CH:21]=[CH:18]3.[NaH]')
    string = string.replace('([CH3:1][C:2]1=[C:3]2[C:5](=[CH:10][CH:8]=[C:4]1[O:7][C@H:29]1[C@H:25]([O:28][C:33]([CH3:37])=[O:38])[C@@H:21]([O:19][C:20]([CH3:22])=[O:23])[C@@H:24]([O:26][C:30]([CH3:34])=[O:35])[C@@H:27]([CH2:31][O:36][C:39]([CH3:40])=[O:41])[O:32]1)[C:9]([CH2:12][S:15](=[O:16])(=[O:17])[OH:18])=[CH:13][C:11](=[O:14])[O:6]2.[NaH])','[CH3:1][C:2]1=[C:3]2[C:5](=[CH:10][CH:8]=[C:4]1[O:7][C@H:29]1[C@H:25]([O:28][C:33]([CH3:37])=[O:38])[C@@H:21]([O:19][C:20]([CH3:22])=[O:23])[C@@H:24]([O:26][C:30]([CH3:34])=[O:35])[C@@H:27]([CH2:31][O:36][C:39]([CH3:40])=[O:41])[O:32]1)[C:9]([CH2:12][S:15](=[O:16])(=[O:17])[OH:18])=[CH:13][C:11](=[O:14])[O:6]2.[NaH]')
    string = string.replace('([H][C@:34]1([C@@H:31]([C@@H:32]([CH2:35][NH2:39])[OH:36])[OH:33])[C@H:37]([NH:40][C:43]([CH3:48])=[O:49])[C@@H:41]([OH:44])[CH2:45][C@@:42]([C:46]([OH:50])=[O:51])([O:47][C@@H:14]2[C@@H:7]([OH:13])[C@H:3]([O:1][C@@H:2]3[C@@H:4]([CH2:8][OH:15])[O:9][C@@H:16]([O:20][CH2:24][CH2:27][N:28]=[N+:29]=[N-:30])[C@H:11]([NH:17][C:21]([CH3:25])=[O:26])[C@H:5]3[OH:10])[O:6][C@H:12]([CH2:18][OH:22])[C@@H:19]2[OH:23])[O:38]1.[NaH])','[H][C@:34]1([C@@H:31]([C@@H:32]([CH2:35][NH2:39])[OH:36])[OH:33])[C@H:37]([NH:40][C:43]([CH3:48])=[O:49])[C@@H:41]([OH:44])[CH2:45][C@@:42]([C:46]([OH:50])=[O:51])([O:47][C@@H:14]2[C@@H:7]([OH:13])[C@H:3]([O:1][C@@H:2]3[C@@H:4]([CH2:8][OH:15])[O:9][C@@H:16]([O:20][CH2:24][CH2:27][N:28]=[N+:29]=[N-:30])[C@H:11]([NH:17][C:21]([CH3:25])=[O:26])[C@H:5]3[OH:10])[O:6][C@H:12]([CH2:18][OH:22])[C@@H:19]2[OH:23])[O:38]1.[NaH]')
    string = string.replace('([CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([O:36][C@H:33]3[C@H:27]([OH:32])[C@@H:22]([OH:26])[C@H:20]([O:19][C@H:21]4[C@H:24]([OH:29])[C@@H:30]([OH:34])[C@H:35]([OH:37])[CH2:31][O:25]4)[CH2:23][O:28]3)=[C:14]([F:18])[CH:10]=[C:7]12.[NaH])','[CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:15])[O:13][C:9]2=[C:12]([F:16])[C:17]([O:36][C@H:33]3[C@H:27]([OH:32])[C@@H:22]([OH:26])[C@H:20]([O:19][C@H:21]4[C@H:24]([OH:29])[C@@H:30]([OH:34])[C@H:35]([OH:37])[CH2:31][O:25]4)[CH2:23][O:28]3)=[C:14]([F:18])[CH:10]=[C:7]12.[NaH]')
    string = string.replace('([CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:16])[O:15][C:10]2=[CH:14][C:17]([O:20][C@H:30]3[C@H:27]([O:29][C:33]([CH3:36])=[O:37])[C@@H:24]([O:22][C:23]([CH3:25])=[O:26])[C@H:28]([O:31][C:35]([CH3:38])=[O:39])[CH2:32][O:34]3)=[C:12]3[C:9](=[C:7]12)[CH:13]=[CH:19][CH:21]=[CH:18]3.[NaH])','[CH2:1]([S:2](=[O:4])(=[O:5])[OH:6])[C:3]1=[CH:8][C:11](=[O:16])[O:15][C:10]2=[CH:14][C:17]([O:20][C@H:30]3[C@H:27]([O:29][C:33]([CH3:36])=[O:37])[C@@H:24]([O:22][C:23]([CH3:25])=[O:26])[C@H:28]([O:31][C:35]([CH3:38])=[O:39])[CH2:32][O:34]3)=[C:12]3[C:9](=[C:7]12)[CH:13]=[CH:19][CH:21]=[CH:18]3.[NaH]')
    string = string.replace('([H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([CH2:19][N:25]=[N+:26]=[N-:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@@:12]([C:17]([OH:23])=[O:24])([O:18][C@@H:41]2[C@@H:34]([OH:40])[C@H:30]([O:28][C@@H:29]3[C@@H:31]([CH2:35][OH:42])[O:36][C@@H:43]([O:47][CH2:50][CH2:51][NH2:52])[C@H:38]([OH:44])[C@H:32]3[OH:37])[O:33][C@H:39]([CH2:45][OH:48])[C@@H:46]2[OH:49])[O:8]1.[NaH])','[H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([CH2:19][N:25]=[N+:26]=[N-:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@@:12]([C:17]([OH:23])=[O:24])([O:18][C@@H:41]2[C@@H:34]([OH:40])[C@H:30]([O:28][C@@H:29]3[C@@H:31]([CH2:35][OH:42])[O:36][C@@H:43]([O:47][CH2:50][CH2:51][NH2:52])[C@H:38]([OH:44])[C@H:32]3[OH:37])[O:33][C@H:39]([CH2:45][OH:48])[C@@H:46]2[OH:49])[O:8]1.[NaH]')
    string = string.replace('([H][C@@:7]1([C@@H:9]([C@@H:12]([CH2:15][N:18]=[N+:21]=[N-:22])[OH:16])[OH:13])[O:3][C@:1]([C:2]([OH:5])=[O:6])([O:42][C@@H:36]2[C@@H:29]([OH:35])[C@H:25]([O:23][C@@H:24]3[C@@H:26]([CH2:30][OH:37])[O:31][C@@H:38]([O:43][CH2:46][C@@H:47]([C@@H:48](/[CH:50]=[CH:52]/[CH2:53][CH2:54][CH2:55][CH2:56][CH2:57][CH2:58][CH2:59][CH2:60][CH2:61][CH2:62][CH2:63][CH2:64][CH3:65])[OH:51])[NH2:49])[C@H:33]([OH:39])[C@H:27]3[OH:32])[O:28][C@H:34]([CH2:40][OH:44])[C@@H:41]2[OH:45])[CH2:4][C@H:8]([OH:11])[C@H:10]1[NH:14][C:17]([CH3:19])=[O:20].[NaH])','[H][C@@:7]1([C@@H:9]([C@@H:12]([CH2:15][N:18]=[N+:21]=[N-:22])[OH:16])[OH:13])[O:3][C@:1]([C:2]([OH:5])=[O:6])([O:42][C@@H:36]2[C@@H:29]([OH:35])[C@H:25]([O:23][C@@H:24]3[C@@H:26]([CH2:30][OH:37])[O:31][C@@H:38]([O:43][CH2:46][C@@H:47]([C@@H:48](/[CH:50]=[CH:52]/[CH2:53][CH2:54][CH2:55][CH2:56][CH2:57][CH2:58][CH2:59][CH2:60][CH2:61][CH2:62][CH2:63][CH2:64][CH3:65])[OH:51])[NH2:49])[C@H:33]([OH:39])[C@H:27]3[OH:32])[O:28][C@H:34]([CH2:40][OH:44])[C@@H:41]2[OH:45])[CH2:4][C@H:8]([OH:11])[C@H:10]1[NH:14][C:17]([CH3:19])=[O:20].[NaH]')
    string = string.replace('([H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([O:19][CH2:25][C:26]#[CH:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@@:12]([C:17]([OH:23])=[O:24])([O:18][C@@H:41]2[C@@H:34]([OH:40])[C@H:30]([O:28][C@@H:29]3[C@@H:31]([CH2:35][OH:42])[O:36][C@@H:43]([O:47][CH2:50][CH2:51][NH2:52])[C@H:38]([OH:44])[C@H:32]3[OH:37])[O:33][C@H:39]([CH2:45][OH:48])[C@@H:46]2[OH:49])[O:8]1.[NaH])','[H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([O:19][CH2:25][C:26]#[CH:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@@:12]([C:17]([OH:23])=[O:24])([O:18][C@@H:41]2[C@@H:34]([OH:40])[C@H:30]([O:28][C@@H:29]3[C@@H:31]([CH2:35][OH:42])[O:36][C@@H:43]([O:47][CH2:50][CH2:51][NH2:52])[C@H:38]([OH:44])[C@H:32]3[OH:37])[O:33][C@H:39]([CH2:45][OH:48])[C@@H:46]2[OH:49])[O:8]1.[NaH]')
    string = string.replace('([H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([CH2:19][N:25]=[N+:26]=[N-:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@@:12]([C:17]([OH:23])=[O:24])([O:18][CH2:45][C@H:39]2[O:33][C@@H:30]([O:28][C@@H:29]3[C@@H:31]([CH2:35][OH:42])[O:36][C@@H:43]([O:48][CH2:50][CH2:51][NH2:52])[C@H:38]([OH:44])[C@H:32]3[OH:37])[C@H:34]([OH:40])[C@@H:41]([OH:47])[C@H:46]2[OH:49])[O:8]1.[NaH])','[H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([CH2:19][N:25]=[N+:26]=[N-:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@@:12]([C:17]([OH:23])=[O:24])([O:18][CH2:45][C@H:39]2[O:33][C@@H:30]([O:28][C@@H:29]3[C@@H:31]([CH2:35][OH:42])[O:36][C@@H:43]([O:48][CH2:50][CH2:51][NH2:52])[C@H:38]([OH:44])[C@H:32]3[OH:37])[C@H:34]([OH:40])[C@@H:41]([OH:47])[C@H:46]2[OH:49])[O:8]1.[NaH]')
    string = string.replace('([H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([O:19][CH2:25][C:26]#[CH:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@@:12]([C:17]([OH:23])=[O:24])([O:18][CH2:45][C@H:39]2[O:33][C@@H:30]([O:28][C@@H:29]3[C@@H:31]([CH2:35][OH:42])[O:36][C@@H:43]([O:48][CH2:50][CH2:51][NH2:52])[C@H:38]([OH:44])[C@H:32]3[OH:37])[C@H:34]([OH:40])[C@@H:41]([OH:47])[C@H:46]2[OH:49])[O:8]1.[NaH])','[H][C@:4]1([C@@H:1]([C@@H:2]([CH2:5][NH:9][C:13]([O:19][CH2:25][C:26]#[CH:27])=[O:20])[OH:6])[OH:3])[C@H:7]([NH:10][C:14]([CH3:21])=[O:22])[C@@H:11]([OH:15])[CH2:16][C@@:12]([C:17]([OH:23])=[O:24])([O:18][CH2:45][C@H:39]2[O:33][C@@H:30]([O:28][C@@H:29]3[C@@H:31]([CH2:35][OH:42])[O:36][C@@H:43]([O:48][CH2:50][CH2:51][NH2:52])[C@H:38]([OH:44])[C@H:32]3[OH:37])[C@H:34]([OH:40])[C@@H:41]([OH:47])[C@H:46]2[OH:49])[O:8]1.[NaH]')

    return string